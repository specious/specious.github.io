/*
 * CSS Flower - By Ildar Sagdejev ( http://j.mp/web-ninja )
 */

@import 'nib/vendor'
@import 'mixins'

count = 5
diameter = 120px
icon_size = 80px
distance = 1.2 // 1 = flush
tumbles = 3
swirl = 720deg // 0 = first leaf at the top; goes clockwise
time = 3.2s
spincycle = 45s
colors = #8a1919, #dce9f6, #2b44cf, #cb56ff, yellow // twitter, fb, photos, codepen, github

// auto
dAngle = 360 / count
grow = 1 + (2 * distance)

//
// Glass cover
//

.glass
  background-image radial-gradient(circle closest-side, rgba(38, 38, 38, 0.2), rgba(0, 0, 0, 0.63))
  background-size 100% 100
  border-radius 50%
  position relative
.glass::before
  position absolute
  width 56%
  height 26%
  top 4%
  left 22%
  border-radius 50%
  background-image linear-gradient(to bottom, rgba(207, 207, 207, 0.23), rgba(30, 30, 30, 0.06))
  content ''
.glass::after
  position absolute
  width 38%
  height 19%
  bottom 3%
  left 31%
  border-radius 50%
  background-image linear-gradient(to bottom, rgba(93, 93, 93, 0.1), rgba(0, 0, 0, 0.18))
  content ''

//
// Interactive spinner
//

.flower
  width diameter
  height diameter
  border-radius 50%
  cursor pointer
  position relative
  .spinner, .inner, .counterspin, .glass-holder
    height 100%
  .spinner
    animation spin spincycle infinite linear
  .counterspin
    animation counter-spin spincycle infinite linear
  .cover
    width diameter
    height diameter
    background-image url(../gfx/cover.jpg)
    background-size 100%
    border-radius 50%
    box-shadow \
      0 0 2px 4px #d1d1d1,
      0 0 20px 4px black
    position absolute
    top 0
  .child
    width diameter
    height diameter
    border-radius 50%
    position absolute
    top 0
    visibility hidden
    .leaf
      height 100%
      color white
      background-size 100%
      border-radius 50%
      opacity 0.94
      transition transform time ease-in-out
      img
        width icon_size
        height icon_size
        left ((diameter - icon_size) / 2)
        top ((diameter - icon_size) / 2)
        position absolute
    for c, i in colors
      &:nth-child({i+1})
        rot = (dAngle * i - 90)
        transform rotate((rot)deg)
        transition visibility time linear
        .leaf
          background-color c
          transition transform time ease-in-out, box-shadow 0.16s ease-in-out
          .glass-holder
            transform rotate(-(rot)deg)
  .glass
    height 100%
    transition transform time ease-in-out
  &:hover, &.open
    transform scale(grow) // zoom click area
    .inner
      transform scale(1 / grow) // but do not zoom internal elements
    .child
      visibility visible
    .leaf
      // Expand
      transform rotate(swirl) translateX(diameter * distance) rotate((tumbles * 360 + 90)deg)
      &:hover
        box-shadow 0 0 34px rgba(211, 217, 255, 1), 0 0 0 1px black, inset 0 1px 0 rgba(255, 255, 255, 0.2)
      .glass
        // Keep the glass cover stationary
        transform rotate((-1 * (swirl + tumbles * 360 + 90))deg)
@keyframes spin
  to
    transform rotate(1turn)
@keyframes counter-spin
  to
    transform rotate(-1turn)